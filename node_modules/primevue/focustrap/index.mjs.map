{"version":3,"file":"index.mjs","sources":["../../src/focustrap/BaseFocusTrap.js","../../src/focustrap/FocusTrap.js"],"sourcesContent":["import BaseDirective from '@primevue/core/basedirective';\nimport FocusTrapStyle from 'primevue/focustrap/style';\n\nconst BaseFocusTrap = BaseDirective.extend({\n    style: FocusTrapStyle\n});\n\nexport default BaseFocusTrap;\n","import { DomHandler, ObjectUtils } from '@primevue/core/utils';\nimport BaseFocusTrap from './BaseFocusTrap';\n\nconst FocusTrap = BaseFocusTrap.extend('focustrap', {\n    mounted(el, binding) {\n        const { disabled } = binding.value || {};\n\n        if (!disabled) {\n            this.createHiddenFocusableElements(el, binding);\n            this.bind(el, binding);\n            this.autoElementFocus(el, binding);\n        }\n\n        el.setAttribute('data-pd-focustrap', true);\n\n        this.$el = el;\n    },\n    updated(el, binding) {\n        const { disabled } = binding.value || {};\n\n        disabled && this.unbind(el);\n    },\n    unmounted(el) {\n        this.unbind(el);\n    },\n    methods: {\n        getComputedSelector(selector) {\n            return `:not(.p-hidden-focusable):not([data-p-hidden-focusable=\"true\"])${selector ?? ''}`;\n        },\n        bind(el, binding) {\n            const { onFocusIn, onFocusOut } = binding.value || {};\n\n            el.$_pfocustrap_mutationobserver = new MutationObserver((mutationList) => {\n                mutationList.forEach((mutation) => {\n                    if (mutation.type === 'childList' && !el.contains(document.activeElement)) {\n                        const findNextFocusableElement = (_el) => {\n                            const focusableElement = DomHandler.isFocusableElement(_el)\n                                ? DomHandler.isFocusableElement(_el, this.getComputedSelector(el.$_pfocustrap_focusableselector))\n                                    ? _el\n                                    : DomHandler.getFirstFocusableElement(el, this.getComputedSelector(el.$_pfocustrap_focusableselector))\n                                : DomHandler.getFirstFocusableElement(_el);\n\n                            return ObjectUtils.isNotEmpty(focusableElement) ? focusableElement : _el.nextSibling && findNextFocusableElement(_el.nextSibling);\n                        };\n\n                        DomHandler.focus(findNextFocusableElement(mutation.nextSibling));\n                    }\n                });\n            });\n\n            el.$_pfocustrap_mutationobserver.disconnect();\n            el.$_pfocustrap_mutationobserver.observe(el, {\n                childList: true\n            });\n\n            el.$_pfocustrap_focusinlistener = (event) => onFocusIn && onFocusIn(event);\n            el.$_pfocustrap_focusoutlistener = (event) => onFocusOut && onFocusOut(event);\n\n            el.addEventListener('focusin', el.$_pfocustrap_focusinlistener);\n            el.addEventListener('focusout', el.$_pfocustrap_focusoutlistener);\n        },\n        unbind(el) {\n            el.$_pfocustrap_mutationobserver && el.$_pfocustrap_mutationobserver.disconnect();\n            el.$_pfocustrap_focusinlistener && el.removeEventListener('focusin', el.$_pfocustrap_focusinlistener) && (el.$_pfocustrap_focusinlistener = null);\n            el.$_pfocustrap_focusoutlistener && el.removeEventListener('focusout', el.$_pfocustrap_focusoutlistener) && (el.$_pfocustrap_focusoutlistener = null);\n        },\n        autoFocus(options) {\n            this.autoElementFocus(this.$el, { value: { ...options, autoFocus: true } });\n        },\n        autoElementFocus(el, binding) {\n            const { autoFocusSelector = '', firstFocusableSelector = '', autoFocus = false } = binding.value || {};\n            let focusableElement = DomHandler.getFirstFocusableElement(el, `[autofocus]${this.getComputedSelector(autoFocusSelector)}`);\n\n            autoFocus && !focusableElement && (focusableElement = DomHandler.getFirstFocusableElement(el, this.getComputedSelector(firstFocusableSelector)));\n            DomHandler.focus(focusableElement);\n        },\n        onFirstHiddenElementFocus(event) {\n            const { currentTarget, relatedTarget } = event;\n            const focusableElement =\n                relatedTarget === currentTarget.$_pfocustrap_lasthiddenfocusableelement || !this.$el?.contains(relatedTarget)\n                    ? DomHandler.getFirstFocusableElement(currentTarget.parentElement, this.getComputedSelector(currentTarget.$_pfocustrap_focusableselector))\n                    : currentTarget.$_pfocustrap_lasthiddenfocusableelement;\n\n            DomHandler.focus(focusableElement);\n        },\n        onLastHiddenElementFocus(event) {\n            const { currentTarget, relatedTarget } = event;\n            const focusableElement =\n                relatedTarget === currentTarget.$_pfocustrap_firsthiddenfocusableelement || !this.$el?.contains(relatedTarget)\n                    ? DomHandler.getLastFocusableElement(currentTarget.parentElement, this.getComputedSelector(currentTarget.$_pfocustrap_focusableselector))\n                    : currentTarget.$_pfocustrap_firsthiddenfocusableelement;\n\n            DomHandler.focus(focusableElement);\n        },\n        createHiddenFocusableElements(el, binding) {\n            const { tabIndex = 0, firstFocusableSelector = '', lastFocusableSelector = '' } = binding.value || {};\n\n            const createFocusableElement = (onFocus) => {\n                return DomHandler.createElement('span', {\n                    class: 'p-hidden-accessible p-hidden-focusable',\n                    tabIndex,\n                    role: 'presentation',\n                    'aria-hidden': true,\n                    'data-p-hidden-accessible': true,\n                    'data-p-hidden-focusable': true,\n                    onFocus: onFocus?.bind(this)\n                });\n            };\n\n            const firstFocusableElement = createFocusableElement(this.onFirstHiddenElementFocus);\n            const lastFocusableElement = createFocusableElement(this.onLastHiddenElementFocus);\n\n            firstFocusableElement.$_pfocustrap_lasthiddenfocusableelement = lastFocusableElement;\n            firstFocusableElement.$_pfocustrap_focusableselector = firstFocusableSelector;\n            firstFocusableElement.setAttribute('data-pc-section', 'firstfocusableelement');\n\n            lastFocusableElement.$_pfocustrap_firsthiddenfocusableelement = firstFocusableElement;\n            lastFocusableElement.$_pfocustrap_focusableselector = lastFocusableSelector;\n            lastFocusableElement.setAttribute('data-pc-section', 'lastfocusableelement');\n\n            el.prepend(firstFocusableElement);\n            el.append(lastFocusableElement);\n        }\n    }\n});\n\nexport default FocusTrap;\n"],"names":["BaseFocusTrap","BaseDirective","extend","style","FocusTrapStyle","FocusTrap","mounted","el","binding","_ref","value","disabled","createHiddenFocusableElements","bind","autoElementFocus","setAttribute","$el","updated","_ref2","unbind","unmounted","methods","getComputedSelector","selector","concat","_this","_ref3","onFocusIn","onFocusOut","$_pfocustrap_mutationobserver","MutationObserver","mutationList","forEach","mutation","type","contains","document","activeElement","findNextFocusableElement","_el","focusableElement","DomHandler","isFocusableElement","$_pfocustrap_focusableselector","getFirstFocusableElement","ObjectUtils","isNotEmpty","nextSibling","focus","disconnect","observe","childList","$_pfocustrap_focusinlistener","event","$_pfocustrap_focusoutlistener","addEventListener","removeEventListener","autoFocus","options","_objectSpread","_ref4","_ref4$autoFocusSelect","autoFocusSelector","_ref4$firstFocusableS","firstFocusableSelector","_ref4$autoFocus","onFirstHiddenElementFocus","_this$$el","currentTarget","relatedTarget","$_pfocustrap_lasthiddenfocusableelement","parentElement","onLastHiddenElementFocus","_this$$el2","$_pfocustrap_firsthiddenfocusableelement","getLastFocusableElement","_this2","_ref5","_ref5$tabIndex","tabIndex","_ref5$firstFocusableS","_ref5$lastFocusableSe","lastFocusableSelector","createFocusableElement","onFocus","createElement","role","firstFocusableElement","lastFocusableElement","prepend","append"],"mappings":"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"}